---
import Layout from "../../layouts/Layout.astro";
import StrategyCard from "../../components/StrategyCard.astro";
import FilterBar from "../../components/FilterBar.astro";
import { strategies, getStrategiesByCategory } from "../../data/strategies";

const fundamentalStrategies = getStrategiesByCategory("fundamental");
const technicalStrategies = getStrategiesByCategory("technical");
const sentimentStrategies = getStrategiesByCategory("sentiment");

const categories = [
    { value: "fundamental", label: "ğŸ›ï¸ åŸºæœ¬é¢" },
    { value: "technical", label: "ğŸ“ˆ æŠ€è¡“é¢" },
    { value: "sentiment", label: "ğŸ’° ç±Œç¢¼é¢" },
];
---

<Layout title="é¸è‚¡ç­–ç•¥">
    <h1>ğŸ¯ é¸è‚¡ç­–ç•¥ä¸­å¿ƒ</h1>
    <p class="page-desc">æ ¹æ“šä¸åŒçš„æŠ•è³‡é¢¨æ ¼èˆ‡ç›®æ¨™ï¼Œé¸æ“‡é©åˆæ‚¨çš„é¸è‚¡ç­–ç•¥ã€‚</p>

    <FilterBar categories={categories} />

    <!-- å…¨éƒ¨ç­–ç•¥å®¹å™¨ -->
    <div id="strategies-container">
        <!-- åŸºæœ¬é¢ç­–ç•¥ -->
        <section class="section strategy-section" data-category="fundamental">
            <h2>ğŸ›ï¸ åŸºæœ¬é¢ç­–ç•¥</h2>
            <p class="section-desc">é©åˆé•·æœŸæŠ•è³‡ã€åƒ¹å€¼æŠ•è³‡è€…</p>
            <div class="grid grid-3">
                {
                    fundamentalStrategies.map((strategy) => (
                        <StrategyCard strategy={strategy} />
                    ))
                }
            </div>
        </section>

        <!-- æŠ€è¡“é¢ç­–ç•¥ -->
        <section class="section strategy-section" data-category="technical">
            <h2>ğŸ“ˆ æŠ€è¡“é¢ç­–ç•¥</h2>
            <p class="section-desc">é©åˆæ³¢æ®µæ“ä½œã€çŸ­ç·šäº¤æ˜“è€…</p>
            <div class="grid grid-3">
                {
                    technicalStrategies.map((strategy) => (
                        <StrategyCard strategy={strategy} />
                    ))
                }
            </div>
        </section>

        <!-- ç±Œç¢¼é¢ç­–ç•¥ -->
        <section class="section strategy-section" data-category="sentiment">
            <h2>ğŸ’° ç±Œç¢¼é¢ç­–ç•¥</h2>
            <p class="section-desc">è·Ÿéš¨ä¸»åŠ›ã€æ³•äººå‹•å‘</p>
            <div class="grid grid-3">
                {
                    sentimentStrategies.map((strategy) => (
                        <StrategyCard strategy={strategy} />
                    ))
                }
            </div>
        </section>
    </div>
</Layout>

<style>
    .page-desc {
        color: var(--text-secondary);
        margin-bottom: 24px;
    }

    .section-desc {
        color: var(--text-secondary);
        margin-bottom: 20px;
        font-size: 0.9rem;
    }

    .strategy-section {
        transition:
            opacity 0.3s,
            transform 0.3s;
    }

    .strategy-section.hidden {
        display: none;
    }
</style>

<script>
    // ç›£è½ç¯©é¸äº‹ä»¶
    window.addEventListener("filter-change", (e: CustomEvent) => {
        const category = e.detail.category;

        document.querySelectorAll(".strategy-section").forEach((section) => {
            const sectionCategory = section.getAttribute("data-category");

            if (category === "all" || sectionCategory === category) {
                section.classList.remove("hidden");
            } else {
                section.classList.add("hidden");
            }
        });
    });
</script>
