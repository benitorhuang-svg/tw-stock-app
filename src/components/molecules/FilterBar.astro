---
interface Props {
    categories: { value: string; label: string }[];
    activeCategory?: string;
}

const { categories, activeCategory = 'all' } = Astro.props;
---

<div class="cyber-filter-bar glass-card glow-wrapper">
    <div class="glow-bg neutral-glow"></div>
    <div class="btn-group">
        <button
            class={`sys-btn mono ${activeCategory === 'all' ? 'active' : ''}`}
            data-category="all"
        >
            ALL_MODULES
        </button>
        {
            categories.map(cat => (
                <button
                    class={`sys-btn mono ${activeCategory === cat.value ? 'active' : ''}`}
                    data-category={cat.value}
                >
                    {cat.label}
                </button>
            ))
        }
    </div>
</div>

<style>
    .cyber-filter-bar {
        background: var(--c-bg-glass);
        backdrop-filter: var(--glass-blur);
        -webkit-backdrop-filter: var(--glass-blur);
        border: 1px solid var(--c-border-glass, rgba(60, 80, 120, 0.2));
        border-radius: 8px;
        padding: 8px;
        display: inline-block;
        position: relative;
        overflow: hidden;
        margin-bottom: 24px;
    }

    .glow-wrapper {
        position: relative;
    }
    .glow-bg {
        position: absolute;
        inset: 0;
        opacity: 0;
        pointer-events: none;
        z-index: 0;
        transition: opacity 0.3s ease;
        background: radial-gradient(
            200px circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
            rgba(255, 255, 255, 0.05),
            transparent 40%
        );
    }
    .cyber-filter-bar:hover .glow-bg {
        opacity: 1;
    }

    .btn-group {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        position: relative;
        z-index: 1;
    }

    .sys-btn {
        padding: 8px 16px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 4px;
        color: var(--c-text-muted);
        cursor: pointer;
        font-size: 11px;
        font-weight: 600;
        transition: 0.2s;
        letter-spacing: 1px;
    }

    .sys-btn:hover {
        border-color: rgba(255, 255, 255, 0.2);
        color: #fff;
    }

    .sys-btn.active {
        background: rgba(var(--c-accent-rgb), 0.1);
        border-color: var(--c-accent);
        color: var(--c-accent);
        text-shadow: 0 0 8px rgba(var(--c-accent-rgb), 0.5);
    }
</style>

<script>
    // Glow Tracker
    document.addEventListener('mousemove', e => {
        const wrappers = document.querySelectorAll('.cyber-filter-bar.glow-wrapper');
        wrappers.forEach(wrapper => {
            const rect = wrapper.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            (wrapper as HTMLElement).style.setProperty('--mouse-x', `${x}px`);
            (wrapper as HTMLElement).style.setProperty('--mouse-y', `${y}px`);
        });
    });

    document.querySelectorAll('.sys-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const category = btn.getAttribute('data-category');

            document.querySelectorAll('.sys-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            window.dispatchEvent(new CustomEvent('filter-change', { detail: { category } }));
        });
    });
</script>
