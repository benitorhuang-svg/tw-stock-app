---
/**
 * MoverRow.astro - Molecule component for a single stock row in a matrix
 */
import { fmtPrice } from '../../utils/format';

import type { StockFullData } from '../../types/stock';

interface Props {
    stock: StockFullData;
    index: number;
    variant: 'bullish' | 'bearish' | 'accent';
}

const { stock, index, variant } = Astro.props;

const isBull = variant === 'bullish';
const isBear = variant === 'bearish';

const itemColorClass = isBull ? 'text-bullish' : isBear ? 'text-bearish' : 'text-accent';

const hoverBorderClass = isBull
    ? 'hover:border-bullish'
    : isBear
      ? 'hover:border-bearish'
      : 'hover:border-accent';

const hoverBgClass = isBull
    ? 'hover:bg-bullish/[0.04]'
    : isBear
      ? 'hover:bg-bearish/[0.04]'
      : 'hover:bg-accent/[0.04]';

const groupHoverTextClass = isBull
    ? 'group-hover:text-bullish'
    : isBear
      ? 'group-hover:text-bearish'
      : 'group-hover:text-accent';
---

<a
    href={`/stocks/${stock.symbol}`}
    class:list={[
        'flex items-center gap-4 px-6 py-4 transition-all group no-underline border-l-2 border-transparent',
        hoverBgClass,
        hoverBorderClass,
    ]}
>
    <span class="text-[8px] font-mono text-text-muted/50 w-3">{index + 1}</span>
    <div class="min-w-0 flex-1">
        <div
            class:list={[
                'text-[11px] font-bold text-text-primary transition-colors truncate',
                groupHoverTextClass,
            ]}
        >
            {stock.name}
        </div>
        <div class="text-[8px] font-mono text-text-muted/70 uppercase mt-0.5">
            ENTITY:{stock.symbol}
        </div>
    </div>
    <div class="text-right">
        <div class="text-[10px] font-mono font-bold text-text-secondary">
            {fmtPrice(stock.price)}
        </div>
        <div class:list={['text-[10px] font-mono font-bold', itemColorClass]}>
            {stock.changePercent >= 0 ? '+' : ''}{stock.changePercent.toFixed(2)}%
        </div>
    </div>
</a>
