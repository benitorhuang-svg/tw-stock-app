---
/**
 * ScrollToTop.astro - Atomic FAB for quick navigation
 * Part of Atomic Design: Atoms
 */
---

<button
    id="scroll-to-top-fab"
    class="fixed right-8 bottom-12 z-[100] w-12 h-12 flex items-center justify-center rounded-full bg-surface-deep/80 text-accent border border-accent/30 shadow-2xl backdrop-blur-xl opacity-0 translate-y-12 pointer-events-none transition-all duration-500 ease-out hover:bg-accent hover:text-white hover:scale-110 active:scale-95 group"
    style="right: 2rem; bottom: 3rem;"
    aria-label="回到頂部"
>
    <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="3"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
        <path d="m18 15-6-6-6 6"></path>
    </svg>

    <!-- Subtle Pulse Ring -->
    <div
        class="absolute inset-0 rounded-full bg-accent/20 animate-ping opacity-0 group-hover:opacity-100 transition-opacity"
    >
    </div>
</button>

<script>
    const setupScrollToTop = () => {
        const fab = document.getElementById('scroll-to-top-fab');
        const scrollTarget = document.getElementById('main-workspace'); // Correct target for our layout

        if (!fab || !scrollTarget) return;

        const onScroll = () => {
            if (scrollTarget.scrollTop > 400) {
                fab.classList.remove('opacity-0', 'translate-x-12', 'pointer-events-none');
                fab.classList.add('opacity-100', 'translate-x-0');
            } else {
                fab.classList.add('opacity-0', 'translate-x-12', 'pointer-events-none');
                fab.classList.remove('opacity-100', 'translate-x-0');
            }
        };

        scrollTarget.addEventListener('scroll', onScroll, { passive: true });

        fab.addEventListener('click', () => {
            scrollTarget.scrollTo({
                top: 0,
                behavior: 'smooth',
            });
        });
    };

    // Initialize on load and on view transitions
    setupScrollToTop();
    document.addEventListener('astro:page-load', setupScrollToTop);
</script>

<style>
    #scroll-to-top-fab {
        --accent-rgb: 59, 130, 246; /* Default accent RGB if not defined */
    }
</style>
