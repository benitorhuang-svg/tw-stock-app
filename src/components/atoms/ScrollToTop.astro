---
/**
 * ScrollToTop.astro - Atomic FAB for quick navigation
 * Part of Atomic Design: Atoms
 */
---

<button
    id="scroll-to-top-fab"
    class="fixed right-0 top-1/2 -translate-y-1/2 z-[100] w-10 h-24 flex flex-col items-center justify-center rounded-l-xl bg-accent/90 text-white shadow-[-10px_0_30px_rgba(0,0,0,0.5)] opacity-0 translate-x-12 pointer-events-none transition-all duration-500 ease-out hover:w-12 hover:bg-accent active:scale-95 group border-y border-l border-white/20 backdrop-blur-xl"
    aria-label="回到底部"
>
    <!-- Vertical Label -->
    <span
        class="text-[9px] font-black tracking-[0.2em] uppercase origin-center -rotate-90 whitespace-nowrap mb-4"
    >
        BACK_TO_TOP
    </span>

    <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="3"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="drop-shadow-md"
    >
        <path d="m18 15-6-6-6 6"></path>
    </svg>
</button>

<script>
    const setupScrollToTop = () => {
        const fab = document.getElementById('scroll-to-top-fab');
        const scrollTarget = document.getElementById('main-workspace'); // Correct target for our layout

        if (!fab || !scrollTarget) return;

        const onScroll = () => {
            if (scrollTarget.scrollTop > 400) {
                fab.classList.remove('opacity-0', 'translate-x-12', 'pointer-events-none');
                fab.classList.add('opacity-100', 'translate-x-0');
            } else {
                fab.classList.add('opacity-0', 'translate-x-12', 'pointer-events-none');
                fab.classList.remove('opacity-100', 'translate-x-0');
            }
        };

        scrollTarget.addEventListener('scroll', onScroll, { passive: true });

        fab.addEventListener('click', () => {
            scrollTarget.scrollTo({
                top: 0,
                behavior: 'smooth',
            });
        });
    };

    // Initialize on load and on view transitions
    setupScrollToTop();
    document.addEventListener('astro:page-load', setupScrollToTop);
</script>

<style>
    #scroll-to-top-fab {
        --accent-rgb: 59, 130, 246; /* Default accent RGB if not defined */
    }
</style>
