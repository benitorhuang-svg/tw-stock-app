---
/**
 * DatabaseExplorer.astro - Main data grid and toolbar
 */
import ExplorerToolbar from '../molecules/ExplorerToolbar.astro';
import DatabaseWelcome from './DatabaseWelcome.astro';
import DatabaseErrorState from '../molecules/DatabaseErrorState.astro';
import DatabaseTableArea from './DatabaseTableArea.svelte';
import DatabaseFooter from '../molecules/DatabaseFooter.astro';
import DatabaseRefreshArea from './DatabaseRefreshArea.astro';
---

<main class="flex-1 min-w-0 flex flex-col bg-base relative">
    <div
        class="absolute inset-0 opacity-[0.02] pointer-events-none bg-[linear-gradient(rgba(255,255,255,0.1)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.1)_1px,transparent_1px)] bg-[size:32px_32px]"
    >
    </div>

    <!-- Loading Indicator -->
    <div
        id="db-loading-bar"
        class="absolute top-0 left-0 h-[2px] bg-accent z-50 transition-all duration-300 shadow-[0_0_10px_#3b82f6]"
        style="width:0; opacity:0;"
    >
    </div>

    <ExplorerToolbar />

    <!-- Table Container -->
    <div class="flex-1 min-h-0 overflow-hidden flex flex-col relative bg-base" id="grid-container">
        <!-- Welcome State -->
        <DatabaseWelcome />

        <DatabaseErrorState />

        <!-- Top Horizontal Scrollbar placeholder for SyncScrollbar sync -->
        <div
            id="top-scrollbar"
            class="hidden mb-1 rounded-t-xl overflow-x-auto opacity-80 hover:opacity-100 transition-opacity cursor-pointer flex-shrink-0"
        >
            <div id="top-scroll-content" class="h-2"></div>
        </div>

        <div
            id="table-scroll-container"
            class="rounded-xl border border-border/50 flex-1 overflow-auto shadow-elevated bg-surface/10 custom-scrollbar relative [contain:content] [backface-visibility:hidden] [transform:translateZ(0)]"
        >
            <DatabaseTableArea client:load />
        </div>
    </div>

    <!-- Data Refresh Dashboard -->
    <DatabaseRefreshArea />
</main>
