---
/**
 * TabSector.astro - Sector Rotation & Relative Strength Monitor (Skill #4)
 */
interface Props {
    symbol: string;
    sector: string;
}

const { symbol, sector = 'Technology' } = Astro.props;

// Mock data for sector rotation
const rotationData = [
    { name: '1D Momentum', rank: 3, total: 24, status: 'leading' },
    { name: '5D Momentum', rank: 8, total: 24, status: 'improving' },
    { name: '20D Momentum', rank: 14, total: 24, status: 'lagging' },
];

const peers = [
    { symbol: '2330', name: 'Âè∞Á©çÈõª', price: 1025, change: +15, relative_strength: 92 },
    { symbol: '2303', name: 'ËÅØÈõª', price: 52.4, change: -0.2, relative_strength: 45 },
    { symbol: '2454', name: 'ËÅØÁôºÁßë', price: 1210, change: +20, relative_strength: 88 },
];
---

<div class="space-y-6 animate-fade-up">
    <!-- Sector Context Header -->
    <div
        class="glass-card p-6 border-l-4 border-accent bg-gradient-to-r from-accent/5 to-transparent"
    >
        <div class="flex items-center gap-4 mb-4">
            <div class="text-3xl">üåê</div>
            <div>
                <h3 class="text-lg font-black text-text-primary uppercase tracking-tighter">
                    ÊâÄÂ±¨Áî¢Ê•≠Ôºö{sector}
                </h3>
                <p class="text-[10px] font-mono text-text-muted uppercase tracking-[0.2em]">
                    Cross-Sector Relative Momentum Scan
                </p>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
            {
                rotationData.map(item => (
                    <div class="p-4 rounded-xl bg-surface-hover/20 border border-border/30">
                        <div class="text-[9px] font-mono font-bold text-text-muted uppercase mb-1">
                            {item.name}
                        </div>
                        <div class="flex items-baseline gap-2">
                            <span class="text-2xl font-mono font-black text-text-primary">
                                #{item.rank}
                            </span>
                            <span class="text-[10px] opacity-40">/ {item.total}</span>
                        </div>
                        <div
                            class:list={[
                                'inline-block px-2 py-0.5 rounded-full text-[8px] font-mono font-bold mt-2 uppercase',
                                item.status === 'leading'
                                    ? 'bg-bullish/10 text-bullish border border-bullish/20'
                                    : item.status === 'improving'
                                      ? 'bg-accent/10 text-accent border border-accent/20'
                                      : 'bg-surface-hover text-text-muted border border-border/20',
                            ]}
                        >
                            {item.status}
                        </div>
                    </div>
                ))
            }
        </div>
    </div>

    <!-- Relative Strength vs Sector -->
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <div class="lg:col-span-8 glass-card p-6 h-[400px] flex flex-col">
            <h3 class="terminal-label mb-6">Áõ∏Â∞çÂº∑Â∫¶ÂàÜÊûê (Relative Strength Index)</h3>
            <div class="flex-1 border-l-2 border-b-2 border-border/30 relative m-4">
                <!-- Mock Chart Line -->
                <svg
                    class="absolute inset-0 w-full h-full"
                    preserveAspectRatio="none"
                    viewBox="0 0 100 100"
                >
                    <path
                        d="M0,80 Q25,70 50,40 T100,20"
                        fill="none"
                        stroke="var(--color-accent)"
                        stroke-width="2"
                        stroke-dasharray="0"></path>
                    <rect x="0" y="40" width="100" height="60" fill="url(#sectorGrad)"></rect>
                    <defs>
                        <linearGradient id="sectorGrad" x1="0" y1="0" x2="0" y2="1">
                            <stop offset="0%" stop-color="var(--color-accent)" stop-opacity="0.1"
                            ></stop>
                            <stop offset="100%" stop-color="var(--color-accent)" stop-opacity="0"
                            ></stop>
                        </linearGradient>
                    </defs>
                </svg>
                <div class="absolute inset-x-0 top-1/2 border-t border-border/20 border-dashed">
                </div>
                <div
                    class="absolute left-2 top-2 text-[9px] font-mono font-black text-accent uppercase bg-accent/10 px-2 py-1 rounded"
                >
                    Outperforming
                </div>
                <div
                    class="absolute left-2 bottom-2 text-[9px] font-mono font-black text-text-muted uppercase bg-surface px-2 py-1 rounded"
                >
                    Underperforming
                </div>
            </div>
        </div>

        <div class="lg:col-span-4 space-y-4">
            <h3 class="terminal-label">Áî¢Ê•≠ÂêåÂÑïËßÄÂØü (Sector Peers)</h3>
            <div class="space-y-3">
                {
                    peers.map(peer => (
                        <div class="p-4 rounded-xl bg-surface-hover/30 border border-border/20 hover:border-accent/40 transition-all group overflow-hidden relative">
                            <div class="absolute inset-y-0 left-0 w-1 bg-accent/0 group-hover:bg-accent transition-all" />
                            <div class="flex items-center justify-between relative">
                                <div>
                                    <div class="text-xs font-black text-text-primary tracking-tighter">
                                        {peer.name}
                                    </div>
                                    <div class="text-[9px] font-mono text-text-muted uppercase mt-0.5">
                                        {peer.symbol}
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-sm font-mono font-bold text-text-primary">
                                        {peer.price}
                                    </div>
                                    <div
                                        class:list={[
                                            'text-[9px] font-mono font-bold',
                                            peer.change > 0 ? 'text-bullish' : 'text-bearish',
                                        ]}
                                    >
                                        {peer.change > 0 ? '+' : ''}
                                        {peer.change}
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3 h-1 w-full bg-surface rounded-full overflow-hidden">
                                <div
                                    class="h-full bg-accent"
                                    style={`width: ${peer.relative_strength}%`}
                                />
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>
    </div>
</div>
