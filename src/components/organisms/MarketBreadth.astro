---
/**
 * MarketBreadth.astro — Market breadth visualization bar
 * Shows advancing vs declining stocks with proportional bar and labels.
 */
interface Props {
    up: number;
    down: number;
    flat: number;
    total: number;
    class?: string;
}

const { up, down, flat, total, class: className = '' } = Astro.props;

const pctUp = total > 0 ? (up / total) * 100 : 0;
const pctDown = total > 0 ? (down / total) * 100 : 0;
const pctFlat = total > 0 ? (flat / total) * 100 : 0;
const ratio = down > 0 ? (up / down).toFixed(2) : '∞';
---

<div class:list={['market-breadth', className]}>
    <!-- Bar only, header moved to parent for better layout control -->

    <!-- Breadth Bar -->
    <div class="w-full h-2 rounded-full bg-surface overflow-hidden flex gap-px">
        <div
            id="breadth-bar-up"
            class="h-full bg-gradient-to-r from-bullish to-bullish/70 rounded-l-full transition-all duration-700 ease-out"
            style={`width: ${pctUp}%`}
        >
        </div>
        <div
            id="breadth-bar-flat"
            class="h-full bg-text-muted/20 transition-all duration-700 ease-out"
            style={`width: ${pctFlat}%`}
        >
        </div>
        <div
            id="breadth-bar-down"
            class="h-full bg-gradient-to-r from-bearish/70 to-bearish rounded-r-full transition-all duration-700 ease-out"
            style={`width: ${pctDown}%`}
        >
        </div>
    </div>

    <!-- Percentage Labels -->
    <div class="flex justify-between mt-1.5 text-[10px] font-mono text-text-muted">
        <span id="breadth-pct-up">{pctUp.toFixed(1)}%</span>
        <span id="breadth-pct-flat">{pctFlat.toFixed(1)}%</span>
        <span id="breadth-pct-down">{pctDown.toFixed(1)}%</span>
    </div>
</div>
