---
/**
 * MoversPanel.astro ‚Äî Top gainers/losers ranking organism
 * Shows strongest and weakest stocks for the day.
 */

interface MoverItem {
    symbol: string;
    name: string;
    price: number;
    change: number;
    changePercent: number;
    volume: string;
}

interface Props {
    title?: string;
    type?: 'gainers' | 'losers';
    items?: MoverItem[];
    class?: string;
}

const { title, type = 'gainers', items = [], class: className = '' } = Astro.props;
const isGainer = type === 'gainers';
const displayTitle = title ?? (isGainer ? 'üöÄ Âº∑Âã¢ËÇ°ÊéíË°å' : 'üìâ Âº±Âã¢ËÇ°ÊéíË°å');

// Fallback demo data
const displayItems: MoverItem[] =
    items.length > 0
        ? items
        : [
              {
                  symbol: '2330',
                  name: 'Âè∞Á©çÈõª',
                  price: 892.0,
                  change: 15.0,
                  changePercent: 1.71,
                  volume: '32,456',
              },
              {
                  symbol: '2454',
                  name: 'ËÅØÁôºÁßë',
                  price: 1280.0,
                  change: 25.0,
                  changePercent: 1.99,
                  volume: '8,234',
              },
              {
                  symbol: '2317',
                  name: 'È¥ªÊµ∑',
                  price: 156.0,
                  change: 3.5,
                  changePercent: 2.29,
                  volume: '45,678',
              },
              {
                  symbol: '2382',
                  name: 'Âª£ÈÅî',
                  price: 312.0,
                  change: 8.0,
                  changePercent: 2.63,
                  volume: '12,345',
              },
              {
                  symbol: '3711',
                  name: 'Êó•ÊúàÂÖâÊäïÊéß',
                  price: 178.5,
                  change: 4.5,
                  changePercent: 2.58,
                  volume: '9,876',
              },
          ];
---

<section
    class:list={['glass-card glow-interactive flex flex-col', className]}
    id={`movers-${type}`}
>
    <!-- Header -->
    <div class="flex items-center justify-between px-5 py-3 border-b border-border">
        <h2 class="text-sm font-bold tracking-wide text-text-primary">{displayTitle}</h2>
        <span class="text-xs text-text-muted font-mono">{displayItems.length} Ê™î</span>
    </div>

    <!-- Stock List -->
    <div class="flex-1 divide-y divide-border/50">
        {
            displayItems.map((stock, i) => (
                <a
                    href={`/stocks/${stock.symbol}`}
                    class="flex items-center justify-between px-5 py-3 transition-colors hover:bg-glass-hover group"
                    data-astro-prefetch
                >
                    <div class="flex items-center gap-3">
                        <span class="text-xs font-mono text-text-muted w-5 text-right">
                            {i + 1}
                        </span>
                        <div>
                            <div class="flex items-center gap-2">
                                <span class="text-sm font-semibold text-text-primary group-hover:text-accent transition-colors">
                                    {stock.name}
                                </span>
                                <span class="text-xs text-text-muted font-mono">
                                    {stock.symbol}
                                </span>
                            </div>
                            <span class="text-xs text-text-muted font-mono">{stock.volume} Âºµ</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="data-value text-sm">{stock.price.toFixed(1)}</div>
                        <span
                            class:list={[
                                'text-xs font-mono font-semibold',
                                isGainer ? 'text-bullish' : 'text-bearish',
                            ]}
                        >
                            {isGainer ? '+' : ''}
                            {stock.changePercent.toFixed(2)}%
                        </span>
                    </div>
                </a>
            ))
        }
    </div>
</section>
